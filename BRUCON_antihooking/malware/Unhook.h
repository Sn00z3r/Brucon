#pragma once
#include "stdafx.h"

void UnHook();



//Solution

/*
////Look up original 5 bytes of NtCreateUserProcess using radare2
BYTE bOriginal[5] = {0x4c,0x8b,0xd1,0xb8,0xc0};
DWORD old_prot;

//Get address of NtCreateUserProcess
DWORD64 dwAddress=(DWORD64)GetProcAddress(GetModuleHandleA("ntdll.dll"), "NtCreateUserProcess");

//Make memory PAGE_EXECUTE_READWRITE
VirtualProtect((PVOID)dwAddress, 5, PAGE_EXECUTE_READWRITE, &old_prot);

//Write original 5 bytes back, byte per byte
*reinterpret_cast<char *>(dwAddress) = bOriginal[0];
*reinterpret_cast<char *>((LPBYTE)dwAddress + 1) = bOriginal[1];
*reinterpret_cast<char *>((LPBYTE)dwAddress + 2) = bOriginal[2];
*reinterpret_cast<char *>((LPBYTE)dwAddress + 3) = bOriginal[3];
*reinterpret_cast<char *>((LPBYTE)dwAddress + 4) = bOriginal[4];

//Set original protection back (old_prot)
VirtualProtect((PVOID)dwAddress, 5, old_prot, &old_prot);
*/